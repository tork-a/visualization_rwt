!function(t,n,e,a){"use strict";function i(){n.body.removeChild(this);var t=f(this.getAttribute("data-backdrop-for"));s.splice(t.index,1),this.off(e.event.transitionEnd,i,!1)}function o(e){if(!e.classList.contains("active")){e.style.display="block",t.setTimeout(function(){e.classList.add("active")},10);var a=c(e.getAttribute("id"));n.body.appendChild(a),s.push({panel:e,backdrop:a})}}function r(t){if(t.classList.contains("active")){t.classList.remove("active"),t.classList.add("panel-closing");var n=function(){t.classList.remove("panel-closing"),t.style.display="none",t.off(e.event.transitionEnd,n)};t.on(e.event.transitionEnd,n);var a=f(t.getAttribute("id"));a&&(a.backdrop.classList.add("fadeout"),a.backdrop.on(e.event.transitionEnd,i,!1))}}var s=[],c=function(t){var e=n.createElement("div");return e.classList.add("backdrop-panel"),e.setAttribute("data-backdrop-for",t),e},l=function(t){for(var e,a=n.querySelectorAll("[data-panel-id], [data-panel-close]");t&&t!==n;t=t.parentNode)for(e=a.length;e--;)if(a[e]===t)return t},d=function(t){var e=l(t.target);if(e){var a=e.getAttribute("data-panel-id");return a?n.querySelector("#"+a):p(t.target)}},f=function(t){for(var n=s.length,e=0;e<n;e++)if(s[e].panel.getAttribute("id")===t){var a=s[e];return a.index=e,a}return null},p=function(t){for(var e,a=n.querySelectorAll(".panel, .panel-full");t&&t!==n;t=t.parentNode)for(e=a.length;e--;)if(a[e]===t&&t.classList.contains("active"))return t},u=function(t){for(;t&&t!==n;t=t.parentNode)if(t.classList.contains("dialog")||t.classList.contains("backdrop-dialog")||t.classList.contains("popover")||t.classList.contains("backdrop-popover"))return!0;return!1};n.on(e.event.start,function(t){if(!((t=t.originalEvent||t).target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification"))&&!u(t.target)&&s.length>0){var n=s[s.length-1].panel,e=p(t.target);e||r(n),e&&e!==n&&e.id!==n.id&&r(n)}}),n.on(e.event.tap,function(t){if(!(t.target.classList.contains("notification")||t.parentNode&&t.target.parentNode.classList.contains("notification")||u(t.target))){var n=l(t.target),e=null;if(n&&(e=d(t))&&(e.classList.contains("active")?r(e):o(e)),!(e=p(t.target))&&!n&&s.length>0){var a=s[s.length-1].panel;p(t.target);r(a)}}}),e.panel=function(t){var e="string"==typeof t?n.querySelector(t):t;if(null===e)throw new Error("The panel with ID "+t+" does not exist");return{open:function(){o(e)},close:function(){r(e)}}},e.panelUtil={closeActive:function(){var t=s.length>0;return t&&r(s[s.length-1].panel),t}},t.phonon=e,"object"==typeof exports?module.exports=e.panel:"function"==typeof define&&define.amd&&define(function(){return e.panel})}(window,document,window.phonon||{});