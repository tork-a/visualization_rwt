!function(t,e){"use strict";function n(t,e){for(var n=0;n<s.length;n++)if(s[n].dialog===t){s[n].cancelCallback=e;break}}function i(){var t=m(this.getAttribute("data-id")),n=t.backdrop;n.classList.remove("fadeout"),document.body.removeChild(n);var o=t.dialog;o.style.visibility="hidden",o.style.display="none",o.classList.remove("close"),o.getAttribute("data-auto")&&document.body.removeChild(o),s.splice(t.index,1),this.off(e.event.transitionEnd,i,!1)}function o(e){var n=getComputedStyle(e),i=n.width,o=n.height;i=i.slice(0,i.length-2),o=o.slice(0,o.length-2);var r=t.innerHeight/2-o/2;e.style.top=r+"px"}function r(t){if(t.style.visibility="visible",t.style.display="block",!t.classList.contains("active")){o(t),t.classList.add("active");var n=t.querySelector(".circle-progress");n&&e.preloader(n).show();var i=f(t.id);s.push({dialog:t,backdrop:i}),document.body.appendChild(i)}}function a(n){if(l(n),n.classList.contains("active")){n.classList.remove("active"),n.classList.add("close");var o=n.querySelector(".circle-progress");o&&e.preloader(o).hide();var r=m(n.id).backdrop;r.on(e.event.transitionEnd,i,!1),t.setTimeout(function(){r.classList.add("fadeout")},1)}}function c(t,e,i){if(u=function(){var e,n=t.querySelector("input");n&&(e=n.value),i(e)},"confirm"===e){var o=t.querySelector(".btn-confirm");o&&(o.fireConfirm=u,o.on("tap",u))}else{n(t,i);var r=t.querySelector(".btn-cancel");r&&r.on("tap",u)}}function l(t){if("function"==typeof u){var e=t.querySelectorAll(".btn-confirm, .btn-cancel");if(e)for(var n=0,i=e.length;n<i;n++)e[n].off("tap",u)}}var d=!1,s=[],u=null,f=function(t){var e=document.createElement("div");return e.setAttribute("data-id",t),e.classList.add("backdrop-dialog"),e},v=function(t){for(var e,n=document.querySelectorAll("[data-dialog-id], [data-dialog-close]");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t)return t},p=function(t){var e=v(t.target);if(e){var n=e.getAttribute("data-dialog-id");return n?document.querySelector("#"+n):g(t.target)}},g=function(t){for(var e,n=document.querySelectorAll(".dialog");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t&&t.classList.contains("active"))return t},m=function(t){for(var e=s.length-1;e>=0;e--)if(s[e].dialog.id===t){var n=s[e];return n.index=e,n}return!1},h=0,b=function(t,e,n,i,o,r){e="string"==typeof e?"<p>"+e+"</p>":"";var a=typeof n;n="string"===a?n:t,i="boolean"!=typeof i||i,o="string"==typeof o?o:"Ok",r="string"==typeof r?r:"Cancel";var c="auto-gen-"+t+"-"+h++,l=document.createElement("div");l.setAttribute("class","dialog"),l.setAttribute("data-cancelable",i),l.setAttribute("data-auto","true"),l.id=c;var d=void 0===a?"":"<h3>"+n+"</h3>",s='<li><a class="btn btn-flat btn-cancel" data-dialog-close="true">'+r+"</a></li>",u="",f="";"alert"===t?s="":"prompt"===t?u='<input type="text" placeholder="">':"passPrompt"===t?u='<input type="password" placeholder="Password">':"indicator"===t&&(e="",f='<div class="circle-progress active padded-bottom"><div class="spinner"></div></div>');var v='<div class="content"><div class="padded-full">'+d+e+u+f+"</div></div>"+("indicator"===t?"":'<ul class="buttons">'+s+'<li><a class="btn btn-flat primary btn-confirm" data-dialog-close="true">'+o+"</a></li></ul>");return l.innerHTML=v,document.body.appendChild(l),l};document.on(e.event.start,function(t){if(s.length>0){var e=s[s.length-1],n=g(t.target);n||"false"!==e.dialog.getAttribute("data-cancelable")&&(a(e.dialog),"function"==typeof e.cancelCallback&&e.cancelCallback()),n&&n!==e.dialog&&n.id!==e.dialog.id&&a(e.dialog)}}),document.on("tap",function(t){var e=v(t.target),n=null;e&&(n=p(t),d=e,n&&(n.classList.contains("active")?a(n):r(n)))}),document.on("keypress",function(t){if(s.length>0&&(13==t.which||13==t.keyCode)){var e=s[s.length-1],n=e.dialog.querySelector(".btn-confirm");return n&&void 0!==n.fireConfirm&&n.fireConfirm(),a(e.dialog),!1}return!0}),e.dialog=function(t){if(void 0===t)return{alert:function(t,e,n,i){var o=b("alert",t,e,n,i);return r(o),{on:function(t,e){c(o,t,e)}}},confirm:function(t,e,n,i,o){var a=b("confirm",t,e,n,i,o);return r(a),{on:function(t,e){c(a,t,e)}}},prompt:function(t,e,n,i,o){var a=b("prompt",t,e,n,i,o);return r(a),{on:function(t,e){c(a,t,e)}}},passPrompt:function(t,e,n,i,o){var a=b("passPrompt",t,e,n,i,o);return r(a),{on:function(t,e){c(a,t,e)}}},indicator:function(t,e){var n=b("indicator","",t,e);return r(n),{on:function(t,e){return c(n,t,e),this},open:function(){return r(n),this},close:function(){return a(n),this}}}};var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The following element "+t+" does not exists");return{open:function(){return r(e),this},close:function(){return a(e),this},on:function(t,n){return c(e,t,n),this},isActive:function(){return!!e.classList.contains("active")}}},e.dialogUtil={closeActive:function(){var t=s.length>0;if(t){var e=s[s.length-1].dialog;"false"!==e.getAttribute("data-cancelable")&&a(e)}return t}},t.phonon=e,"object"==typeof exports?module.exports=e.dialog:"function"==typeof define&&define.amd&&define(function(){return e.dialog})}("undefined"!=typeof window?window:this,window.phonon||{});